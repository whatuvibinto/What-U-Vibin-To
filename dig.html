<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIG - WHAT U VIBIN TO?</title>
    <link rel="stylesheet" href="css/style_index.css">
    <link rel="stylesheet" href="css/style_dig.css">
</head>
<body class="dig-page">

<div class="marquee-wrapper">
    <div class="marquee-content">
        WHAT U VIBIN TO? /// KEEP DIGGING /// WHAT U VIBIN TO? /// KEEP DIGGING /// WHAT U VIBIN TO? /// KEEP DIGGING ///
    </div>
</div>

<div class="container">
    <div class="header-logo-wrapper dig-logo">
        <a href="index.html">
            <img src="images/logo.svg" alt="WHAT U VIBIN TO?">
        </a>
    </div>

    <div class="dig-content">
        <div class="search-area">
            <input type="text" class="search-input" id="searchInput" placeholder="Search by name or location...">
            <button class="search-btn">üîç</button>
        </div>

        <div class="profile-list" id="profileContainer">
            </div>
    </div>

    <div class="footer">
        KEEP DIGGING, KEEP VIBING.
    </div>
</div>

<div class="qr-modal-overlay" id="qrModal">
    <div class="qr-modal-content">
        <span class="qr-modal-close" onclick="closeQrModal()">&times;</span>
        <h2 class="qr-modal-name" id="modalName">NAME</h2>
        <p class="qr-modal-genre" id="modalGenre">GENRE</p>
        <img src="" alt="QR Code" class="qr-modal-img" id="modalQr">
        <p style="font-size:0.8rem; color:#888;">Scan to listen to the playlist</p>
    </div>
</div>

<script src="js/dig_data.js"></script>
<script>
    // „Éá„Éº„Çø„Çí„ÇÇ„Å®„Å´HTML„ÇíÁîüÊàê„Åô„Çã„Çπ„ÇØ„É™„Éó„Éà
    const container = document.getElementById('profileContainer');
    const modal = document.getElementById('qrModal');
    const modalName = document.getElementById('modalName');
    const modalGenre = document.getElementById('modalGenre');
    const modalQr = document.getElementById('modalQr');

    function renderProfiles(data) {
        let html = '';
        data.forEach((person, index) => {
            // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÈÅÖÂª∂
            const delay = index * 0.05; 
            
            // „Ç∏„É£„É≥„É´Ë°®Á§∫Áî®„ÉÜ„Ç≠„Çπ„Éà
            const genreText = person.genre.join(', ');

            // „Ç´„Éº„Éâ„ÅÆHTML („ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„ÇíË®≠ÂÆö)
            // onclick„Åß openQrModal „ÇíÂëº„Å≥Âá∫„Åô
            html += `
            <div class="profile-card" style="animation-delay: ${delay}s" 
                 onclick="openQrModal('${person.name}', '${genreText}', '${person.qr}')">
                <div class="profile-img">
                    <img src="${person.image}" alt="${person.name}">
                </div>
                <div class="profile-info">
                    <h2 class="profile-name">${person.name}</h2>
                    <span class="profile-loc">${person.location}</span>
                </div>
            </div>
            `;
        });
        container.innerHTML = html;
    }

    // ÂàùÂõûË°®Á§∫
    renderProfiles(digData);

    // Ê§úÁ¥¢Ê©üËÉΩ
    const searchInput = document.getElementById('searchInput');
    searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        const filtered = digData.filter(person => 
            person.name.toLowerCase().includes(term) || 
            person.location.toLowerCase().includes(term) ||
            person.genre.some(g => g.toLowerCase().includes(term))
        );
        renderProfiles(filtered);
    });

    // --- „É¢„Éº„ÉÄ„É´Âà∂Âæ°Èñ¢Êï∞ ---
    
    // „É¢„Éº„ÉÄ„É´„ÇíÈñã„Åè
    window.openQrModal = function(name, genre, qrSrc) {
        modalName.textContent = name;
        modalGenre.textContent = genre;
        modalQr.src = qrSrc;
        
        modal.classList.add('active');
    };

    // „É¢„Éº„ÉÄ„É´„ÇíÈñâ„Åò„Çã
    window.closeQrModal = function() {
        modal.classList.remove('active');
    };

    // „É¢„Éº„ÉÄ„É´„ÅÆËÉåÊôØ„ÇØ„É™„ÉÉ„ÇØ„Åß„ÇÇÈñâ„Åò„Çã
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeQrModal();
        }
    });

</script>

</body>
</html>
